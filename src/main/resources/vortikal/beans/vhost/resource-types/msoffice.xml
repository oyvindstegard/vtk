<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<beans>

  <bean id="ooXmlResourceTypeDefinition"
        class="org.vortikal.repository.resourcetype.PrimaryResourceTypeDefinitionImpl">
    <property name="name" value="ooxml"/>
    <property name="namespace" ref="DEFAULT_NAMESPACE" />
    <property name="parentTypeDefinition" ref="fileResourceTypeDefinition" />
    <property name="assertions">
      <list>
        <ref bean="contentTypeMatchesOoXml" />
      </list>
    </property>
  </bean>

  <bean id="docResourceTypeDefinition"
        class="org.vortikal.repository.resourcetype.PrimaryResourceTypeDefinitionImpl">
    <property name="name" value="doc"/>
    <property name="namespace" ref="DEFAULT_NAMESPACE" />
    <property name="parentTypeDefinition" ref="ooXmlResourceTypeDefinition" />
    <property name="assertions">
      <list>
        <ref bean="contentTypeMatchesDoc" />
      </list>
    </property>
  </bean>
  
  <bean id="xlsResourceTypeDefinition"
        class="org.vortikal.repository.resourcetype.PrimaryResourceTypeDefinitionImpl">
    <property name="name" value="xls"/>
    <property name="namespace" ref="DEFAULT_NAMESPACE" />
    <property name="parentTypeDefinition" ref="ooXmlResourceTypeDefinition" />
    <property name="assertions">
      <list>
        <ref bean="contentTypeMatchesXls" />
      </list>
    </property>
  </bean>
  
  
  <bean id="pptResourceTypeDefinition"
        class="org.vortikal.repository.resourcetype.PrimaryResourceTypeDefinitionImpl">
    <property name="name" value="ppt"/>
    <property name="namespace" ref="DEFAULT_NAMESPACE" />
    <property name="parentTypeDefinition" ref="ooXmlResourceTypeDefinition" />
    <property name="assertions">
      <list>
        <ref bean="contentTypeMatchesPpt" />
      </list>
    </property>
  </bean>
  
  <bean id="contentTypeMatchesOoXml" class="org.vortikal.web.service.ResourceContentTypeRegexpAssertion">
    <property name="pattern" value="application/(vnd\.ms-excel|msword|vnd\.ms-word\.document|ms-excel|x-msexcel|ms-ppt|vnd\.ms-powerpoint|vnd\.openxmlformats-officedocument\.(wordprocessingml\.document|wordprocessingml\.template|spreadsheetml\.sheet|spreadsheetml\.template|presentationml\.presentation|presentationml\.template|presentationml\.slideshow))" />
  </bean>

  <bean id="contentTypeMatchesDoc" class="org.vortikal.web.service.ResourceContentTypeRegexpAssertion">
    <property name="pattern" value="application/(msword|vnd\.ms-word\.document|vnd\.openxmlformats-officedocument\.wordprocessingml\.document|vnd\.openxmlformats-officedocument\.wordprocessingml\.template)" />
  </bean>
  
  <bean id="contentTypeMatchesXls" class="org.vortikal.web.service.ResourceContentTypeRegexpAssertion">
    <property name="pattern" value="application/(vnd\.ms-excel|x-msexcel|vnd\.openxmlformats-officedocument\.spreadsheetml\.sheet|vnd\.openxmlformats-officedocument\.spreadsheetml\.template)" />
  </bean>
  
  <bean id="contentTypeMatchesPpt" class="org.vortikal.web.service.ResourceContentTypeRegexpAssertion">
    <property name="pattern" value="application/(ms-ppt|vnd\.ms-powerpoint|vnd\.openxmlformats-officedocument\.presentationml\.presentation|vnd\.openxmlformats-officedocument\.presentationml\.template|vnd\.openxmlformats-officedocument\.presentationml\.slideshow)" />
  </bean>

</beans>
