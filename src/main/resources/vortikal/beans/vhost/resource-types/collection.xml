<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<beans>

  <!-- Resource type 'collection' -->
  <bean id="collectionResourceTypeDefinition"
    class="org.vortikal.repository.resourcetype.PrimaryResourceTypeDefinitionImpl">
    <property name="name" value="collection" />
    <property name="namespace" ref="DEFAULT_NAMESPACE" />
    <property name="assertions">
      <list>
        <ref bean="collectionAssertion" />
      </list>
    </property>
    <property name="mixinTypeDefinitions">
      <list>
        <ref bean="visualProfileMixinResourceTypeDef" />
        <ref bean="navigationMixinResourceTypeDef" />
      </list>
    </property>
    <property name="parentTypeDefinition" ref="resourceResourceTypeDefinition" />
    <property name="propertyTypeDefinitions">
      <list>
        <ref bean="collectionTitlePropDef" />
        <ref bean="collectionOverriddenTitlePropDef" />
        <ref bean="skipInPathPropDef" />
        <ref bean="typePropDef" />
      </list>
    </property>
  </bean>

  <bean id="typePropDef" class="org.vortikal.repository.resourcetype.PropertyTypeDefinitionImpl" parent="abstractPropDef">
    <property name="name" value="type" />
    <property name="type" value="STRING" />
    <property name="protectionLevel" ref="PROTECTION_LEVEL_ACL_WRITE" />
    <property name="mandatory" value="false" />
    <property name="vocabulary">
      <bean class="org.vortikal.repository.resourcetype.ValueVocabulary">
        <property name="values">
          <list>
            <bean class="org.vortikal.repository.resourcetype.Value">
              <constructor-arg type="java.lang.String">
                <value>portal-page</value>
              </constructor-arg>
            </bean>
          </list>
        </property>
      </bean>
    </property>
  </bean>

  <bean id="collectionTitlePropDef"
        class="org.vortikal.repository.resourcetype.OverridablePropertyTypeDefinitionImpl" parent="abstractPropDef">
    <property name="name" value="collectionTitle" />
    <property name="protectionLevel" ref="PROTECTION_LEVEL_UNEDITABLE" />
    <property name="mandatory" value="false" />
    <property name="createEvaluator" ref="collectionTitlePropertyEvaluator" />
    <property name="propertiesModificationEvaluator" ref="collectionTitlePropertyEvaluator" />
    <property name="nameModificationEvaluator" ref="collectionTitlePropertyEvaluator" />
  </bean>

  <bean id="collectionTitlePropertyEvaluator" parent="titleEvaluator">
    <property name="capitalizeResourceNames" value="true" />
  </bean>

  <bean id="collectionOverriddenTitlePropDef"
        class="org.vortikal.repository.resourcetype.OverridingPropertyTypeDefinitionImpl">
    <property name="overriddenPropDef" ref="titlePropDef" />
    <property name="createEvaluator" ref="collectionOverriddenTitlePropertyEvaluator" />
    <property name="contentModificationEvaluator" ref="collectionOverriddenTitlePropertyEvaluator" />
    <property name="propertiesModificationEvaluator" ref="collectionOverriddenTitlePropertyEvaluator" />
    <property name="nameModificationEvaluator" ref="collectionOverriddenTitlePropertyEvaluator" />
  </bean>

  <bean id="collectionOverriddenTitlePropertyEvaluator" parent="titleEvaluator">
    <property name="fallbackTitlePropDef" ref="collectionTitlePropDef"/>
  </bean>


  <bean id="skipInPathPropDef" class="org.vortikal.repository.resourcetype.PropertyTypeDefinitionImpl" parent="abstractPropDef">
    <property name="name" value="skipInPath" />
    <property name="type" value="BOOLEAN" />
    <property name="protectionLevel" ref="PROTECTION_LEVEL_ACL_WRITE" />
    <property name="mandatory" value="false" />
    <property name="vocabulary">
      <bean class="org.vortikal.repository.resourcetype.ValueVocabulary">
        <property name="type" value="BOOLEAN" />
        <property name="values">
          <list>
            <bean class="org.vortikal.repository.resourcetype.Value">
              <constructor-arg type="boolean">
                <value>true</value>
              </constructor-arg>
            </bean>
          </list>
        </property>
      </bean>
    </property>
  </bean>
<!--  <bean id="skipInPathPropDef" class="org.vortikal.repository.resourcetype.PropertyTypeDefinitionImpl" parent="abstractPropDef">-->
<!--    <property name="name" value="skipInPath" />-->
<!--    <property name="type" value="BOOLEAN" />-->
<!--    <property name="protectionLevel" ref="PROTECTION_LEVEL_ACL_WRITE" />-->
<!--    <property name="mandatory" value="false" />-->
<!--    <property name="vocabulary">-->
<!--      <bean class="org.vortikal.repository.resourcetype.ValueVocabulary">-->
<!--        <property name="type" value="BOOLEAN" />-->
<!--        <property name="values">-->
<!--          <list>-->
<!--            <bean class="org.vortikal.repository.resourcetype.Value">-->
<!--              <constructor-arg type="boolean">-->
<!--                <value>true</value>-->
<!--              </constructor-arg>-->
<!--            </bean>-->
<!--          </list>-->
<!--        </property>-->
<!--      </bean>-->
<!--    </property>-->
<!--  </bean>-->

  <!-- Assertion that matches all collection resources -->
  <bean id="collectionAssertion" class="org.vortikal.web.service.ResourceIsCollectionAssertion" />

</beans>
