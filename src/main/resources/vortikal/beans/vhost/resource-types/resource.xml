<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<beans>

  <!-- Resource - base resource type -->

  <bean id="resourceResourceTypeDefinition" class="org.vortikal.repository.resourcetype.PrimaryResourceTypeDefinitionImpl">
    <property name="name" value="resource"/>
    <property name="namespace" ref="DEFAULT_NAMESPACE" />
    <property name="mixinTypeDefinitions">
      <list>
        <ref bean="contentDescriptionMixinResourceTypeDef" />
        <ref bean="headerControlMixinResourceTypeDef" />
        <ref bean="scientificDisciplinesMixinResourceTypeDef" />
      </list>
    </property>    
    <property name="propertyTypeDefinitions">
      <list>
        <ref bean="ownerPropDef" />
        <ref bean="createdByPropDef" />
        <ref bean="collectionPropDef" />
        <ref bean="creationTimePropDef" />
        <ref bean="contentLastModifiedPropDef" />
        <ref bean="contentModifiedByPropDef" />
        <ref bean="propertiesLastModifiedPropDef" />
        <ref bean="propertiesModifiedByPropDef" />
        <ref bean="lastModifiedPropDef" />
        <ref bean="modifiedByPropDef" />
        <ref bean="userTitlePropDef" />
        <ref bean="titlePropDef" />
      </list>
    </property>
  </bean>

  
  <bean id="titlePropDef" class="org.vortikal.repository.resourcetype.OverridablePropertyTypeDefinitionImpl">
    <property name="name" value="title" />
    <property name="type" ref="TYPE_STRING" />
    <property name="protectionLevel" ref="PROTECTION_LEVEL_UNEDITABLE" />
    <property name="mandatory" value="true" />
    <property name="createEvaluator" ref="titleEvaluator" />
    <property name="contentModificationEvaluator" ref="titleEvaluator" />
    <property name="nameModificationEvaluator" ref="titleEvaluator" />
  </bean>

  <bean id="titleEvaluator" class="org.vortikal.repository.resourcetype.property.DefaultTitleEvaluator">
    <property name="propertyDefinition" ref="userTitlePropDef" />
  </bean>

  <bean id="userTitlePropDef" class="org.vortikal.repository.resourcetype.PropertyTypeDefinitionImpl">
    <property name="name" value="userTitle"/>
    <property name="type" ref="TYPE_STRING"/>
    <property name="protectionLevel" ref="PROTECTION_LEVEL_ACL_WRITE"/>
    <property name="mandatory" value="false"/>
  </bean>

  <bean id="createdByPropDef" class="org.vortikal.repository.resourcetype.PropertyTypeDefinitionImpl">
    <property name="name" value="createdBy" />
    <property name="type" ref="TYPE_PRINCIPAL" />
    <property name="protectionLevel" ref="PROTECTION_LEVEL_ROLE_ADMIN" />
    <property name="mandatory" value="true" />
    <property name="createEvaluator" ref="ownerEvaluator" />
  </bean>

  <bean id="ownerPropDef" class="org.vortikal.repository.resourcetype.PropertyTypeDefinitionImpl">
    <property name="name" value="owner" />
    <property name="type" ref="TYPE_PRINCIPAL" />
    <property name="protectionLevel" ref="PROTECTION_LEVEL_ACL_ADMIN" />
    <property name="mandatory" value="true" />
    <property name="createEvaluator" ref="ownerEvaluator" />
    <property name="validator" ref="ownerEvaluator" />
  </bean>

  <bean id="ownerEvaluator" class="org.vortikal.repository.resourcetype.property.OwnerEvaluator">
    <property name="principalManager" ref="principalManager" />
    <property name="authorizationManager" ref="authorizationManager" />
  </bean>
  
  <bean id="principalEvaluator" class="org.vortikal.repository.resourcetype.property.PrincipalEvaluator">
    <property name="principalManager" ref="principalManager" />
  </bean>

  <bean id="collectionPropDef" class="org.vortikal.repository.resourcetype.PropertyTypeDefinitionImpl">
    <property name="name" value="collection" />
    <property name="type" ref="TYPE_BOOLEAN" />
    <property name="protectionLevel" ref="PROTECTION_LEVEL_UNEDITABLE" />
    <property name="mandatory" value="true" />
    <property name="createEvaluator" ref="collectionEvaluator" /> 
  </bean>

  <bean id="collectionEvaluator" class="org.vortikal.repository.resourcetype.property.CollectionEvaluator" />


  <bean id="creationTimePropDef" class="org.vortikal.repository.resourcetype.PropertyTypeDefinitionImpl">
    <property name="name" value="creationTime" />
    <property name="type" ref="TYPE_DATE" />
    <property name="protectionLevel" ref="PROTECTION_LEVEL_ROLE_ADMIN" />
    <property name="mandatory" value="true" />
    <property name="createEvaluator" ref="creationTimeEvaluator" />
  </bean>

  <bean id="creationTimeEvaluator" 
        class="org.vortikal.repository.resourcetype.property.CreationTimeEvaluator" />


  <bean id="contentLastModifiedPropDef" class="org.vortikal.repository.resourcetype.PropertyTypeDefinitionImpl">
    <property name="name" value="contentLastModified" />
    <property name="type" ref="TYPE_DATE" />
    <property name="protectionLevel" ref="PROTECTION_LEVEL_ROLE_ADMIN" />
    <property name="mandatory" value="true" />
    <property name="createEvaluator" ref="contentLastModifiedEvaluator" />
    <property name="contentModificationEvaluator" ref="contentLastModifiedEvaluator" />
  </bean>

  <bean id="contentLastModifiedEvaluator" class="org.vortikal.repository.resourcetype.property.ContentLastModifiedEvaluator" />
  

  <bean id="contentModifiedByPropDef" class="org.vortikal.repository.resourcetype.PropertyTypeDefinitionImpl">
    <property name="name" value="contentModifiedBy" />
    <property name="type" ref="TYPE_PRINCIPAL" />
    <property name="protectionLevel" ref="PROTECTION_LEVEL_ROLE_ADMIN" />
    <property name="mandatory" value="true" />
    <property name="createEvaluator" ref="contentModifiedByEvaluator" />
    <property name="contentModificationEvaluator" ref="contentModifiedByEvaluator" />
  </bean>

  <bean id="contentModifiedByEvaluator" class="org.vortikal.repository.resourcetype.property.ContentModifiedByEvaluator" />
  

  <bean id="propertiesLastModifiedPropDef" class="org.vortikal.repository.resourcetype.PropertyTypeDefinitionImpl">
    <property name="name" value="propertiesLastModified" />
    <property name="type" ref="TYPE_DATE" />
    <property name="protectionLevel" ref="PROTECTION_LEVEL_ROLE_ADMIN" />
    <property name="mandatory" value="true" />
    <property name="createEvaluator" ref="propertiesLastModifiedEvaluator" />
    <property name="propertiesModificationEvaluator" ref="propertiesLastModifiedEvaluator" />
  </bean>

  <bean id="propertiesLastModifiedEvaluator" class="org.vortikal.repository.resourcetype.property.PropertiesLastModifiedEvaluator" />
  

  <bean id="propertiesModifiedByPropDef" class="org.vortikal.repository.resourcetype.PropertyTypeDefinitionImpl">
    <property name="name" value="propertiesModifiedBy" />
    <property name="type" ref="TYPE_PRINCIPAL" />
    <property name="protectionLevel" ref="PROTECTION_LEVEL_ROLE_ADMIN" />
    <property name="mandatory" value="true" />
    <property name="createEvaluator" ref="propertiesModifiedByEvaluator" />
    <property name="propertiesModificationEvaluator" ref="propertiesModifiedByEvaluator" />
  </bean>

  <bean id="propertiesModifiedByEvaluator" class="org.vortikal.repository.resourcetype.property.PropertiesModifiedByEvaluator" />
  

  <bean id="lastModifiedPropDef" class="org.vortikal.repository.resourcetype.PropertyTypeDefinitionImpl">
    <property name="name" value="lastModified" />
    <property name="type" ref="TYPE_DATE" />
    <property name="protectionLevel" ref="PROTECTION_LEVEL_UNEDITABLE" />
    <property name="mandatory" value="true" />
    <property name="createEvaluator" ref="lastModifiedEvaluator" />
    <property name="propertiesModificationEvaluator" ref="lastModifiedEvaluator" />
    <property name="contentModificationEvaluator" ref="lastModifiedEvaluator" />
  </bean>

  <bean id="lastModifiedEvaluator" class="org.vortikal.repository.resourcetype.property.LastModifiedEvaluator" />


  <bean id="modifiedByPropDef" class="org.vortikal.repository.resourcetype.PropertyTypeDefinitionImpl">
    <property name="name" value="modifiedBy" />
    <property name="type" ref="TYPE_PRINCIPAL" />
    <property name="protectionLevel" ref="PROTECTION_LEVEL_UNEDITABLE" />
    <property name="mandatory" value="true" />
    <property name="createEvaluator" ref="lastModifiedByEvaluator" />
    <property name="contentModificationEvaluator" ref="lastModifiedByEvaluator" />
    <property name="propertiesModificationEvaluator" ref="lastModifiedByEvaluator" />
  </bean>

  <bean id="lastModifiedByEvaluator" class="org.vortikal.repository.resourcetype.property.LastModifiedByEvaluator" />


</beans>
