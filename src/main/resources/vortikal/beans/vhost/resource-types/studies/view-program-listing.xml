<?xml version="1.0" encoding="utf-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">

  <bean id="programListing.viewService" class="org.vortikal.web.service.ServiceImpl">
    <property name="parent" ref="collectionListing.viewService" />
    <property name="order" value="0" />
    <property name="assertions">
      <list>
        <ref bean="resourceIsProgramListing" />
      </list>
    </property>
    <property name="handler" ref="programListing.handler" />
    <property name="serviceNameProvider" ref="collectionListing.viewService.serviceNameProvider" />
  </bean>

  <bean id="programListing.handler" class="org.vortikal.web.display.collection.studies.ProgramListingController"
    parent="collectionListing.handler">

    <property name="searchComponentsMap">
      <map>
        <entry key="default" value-ref="searchComponents" />
        <entry key="faculty" value-ref="facultySearchComponents" />
        <entry key="alphabetical" value-ref="alphabeticalSearchComponents" />
        <entry key="alphabeticalFaculty" value-ref="alphabeticalFacultySearchComponents" />
      </map>
    </property>
    <property name="viewName" value="programListing.view" />
    <property name="facultyPropDef" ref="facultyPropDef" />
    <property name="sortBy" ref="programSortPropDef" />
  </bean>

  <bean id="searchComponents" class="java.util.ArrayList">
    <constructor-arg>
      <list>
        <ref bean="bachelorProgramListing.searchComponent" />
        <ref bean="masterProgramListing.searchComponent" />
        <ref bean="professionProgramListing.searchComponent" />
        <ref bean="ettoghalvt-aarig-masterProgramListing.searchComponent" />
        <ref bean="to-aarig-masterProgramListing.searchComponent" />
        <ref bean="earingsbasert-masterMasterProgramListing.searchComponent" />
        <ref bean="aarsenhetProgramListing.searchComponent" />
        <ref bean="inactivtProgramListing.SearchComponent" />
      </list>
    </constructor-arg>
  </bean>

  <bean id="facultySearchComponents" class="java.util.ArrayList">
    <constructor-arg>
      <list>
        <ref bean="facultyBachelorProgramListing.searchComponent" />
        <ref bean="facultyMasterProgramListing.searchComponent" />
        <ref bean="facultyProfessionProgramListing.searchComponent" />
        <ref bean="facultyEttoghalvt-aarig-masterProgramListing.searchComponent" />
        <ref bean="facultyTo-aarig-masterProgramListing.searchComponent" />
        <ref bean="facultyerEaringsbasert-masterMasterProgramListing.searchComponent" />
        <ref bean="facultyAarsenhetProgramListing.searchComponent" />
        <ref bean="inactivtProgramListing.facultySearchComponent" />
      </list>
    </constructor-arg>
  </bean>

  <bean id="alphabeticalSearchComponents" class="java.util.ArrayList">
    <constructor-arg>
      <list>
        <ref bean="programListing.searchComponent" />
        <ref bean="inactivtProgramListing.SearchComponent" />
      </list>
    </constructor-arg>
  </bean>

  <bean id="alphabeticalFacultySearchComponents" class="java.util.ArrayList">
    <constructor-arg>
      <list>
        <ref bean="programListing.facultySearchComponent" />
        <ref bean="inactivtProgramListing.SearchComponent" />
      </list>
    </constructor-arg>
  </bean>

  <bean id="programListing.searchComponent" parent="collectionListing.searchComponent">
    <property name="name" value="programListing.defaultListing" />
    <property name="listingUriQueryBuilder" ref="collection.defaultRecursiveListingUriQueryBuilder" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString" value="type IN program-frontpage AND resource:status = aktivt" />
        </bean>
      </list>
    </property>
    <property name="listableProperties">
      <list>
        <bean class="org.vortikal.web.search.PropertyDisplayConfig">
          <property name="displayProperty" ref="introductionImagePropDef" />
          <property name="preventDisplayProperty" ref="articleListing.hideIntroductionImagePropDef" />
        </bean>
        <bean class="org.vortikal.web.search.PropertyDisplayConfig">
          <property name="displayProperty" ref="introductionPropDef" />
          <property name="preventDisplayProperty" ref="articleListing.hideIntroductionPropDef" />
        </bean>
      </list>
    </property>
    <property name="searchSorting" ref="professionProgramListing.searchSorting" />
  </bean>

  <bean id="inactivtProgramListing.facultySearchComponent" parent="programListing.searchComponent">
    <property name="name" value="inactive" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:status != aktivt AND resource:faculty = {$propertyValue:program-listing:faculty}" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="inactivtProgramListing.SearchComponent" parent="programListing.searchComponent">
    <property name="name" value="inactive" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString" value="type IN program-frontpage AND resource:status != aktivt" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="programListing.facultySearchComponent" parent="programListing.searchComponent">
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:faculty = {$propertyValue:program-listing:faculty} AND resource:status = aktivt" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="aarsenhetProgramListing.searchComponent" parent="programListing.searchComponent">
    <property name="name" value="aarsenhet" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:program-type = aarsenhet AND resource:status = aktivt" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="to-aarig-masterProgramListing.searchComponent" parent="programListing.searchComponent">
    <property name="name" value="to-aarig-master" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:program-type = to-aarig-master AND resource:status = aktivt" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="ettoghalvt-aarig-masterProgramListing.searchComponent" parent="programListing.searchComponent">
    <property name="name" value="ettoghalvt-aarig-master" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:program-type = ettoghalvt-aarig-master AND resource:status = aktivt" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="masterProgramListing.searchComponent" parent="programListing.searchComponent">
    <property name="name" value="fem-aarig-master" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:program-type = fem-aarig-master AND resource:status = aktivt" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="bachelorProgramListing.searchComponent" parent="programListing.searchComponent">
    <property name="name" value="bachelor" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:program-type = bachelor AND resource:status = aktivt" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="earingsbasert-masterMasterProgramListing.searchComponent" parent="programListing.searchComponent">
    <property name="name" value="erfaringsbasert-master" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:program-type = erfaringsbasert-master AND resource:status = aktivt" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="professionProgramListing.searchComponent" parent="programListing.searchComponent">
    <property name="name" value="profession" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:program-type = profesjon AND resource:status = aktivt" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="facultyMasterProgramListing.searchComponent" parent="programListing.searchComponent">
    <property name="name" value="fem-aarig-master" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:program-type = fem-aarig-master AND resource:faculty = {$propertyValue:program-listing:faculty} AND resource:status = aktivt" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="facultyEttoghalvt-aarig-masterProgramListing.searchComponent" parent="programListing.searchComponent">
    <property name="name" value="ettoghalvt-aarig-master" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:program-type = ettoghalvt-aarig-master AND resource:status = aktivt AND resource:faculty = {$propertyValue:program-listing:faculty}" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="facultyTo-aarig-masterProgramListing.searchComponent" parent="programListing.searchComponent">
    <property name="name" value="to-aarig-master" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:program-type = to-aarig-master AND resource:faculty = {$propertyValue:program-listing:faculty} AND resource:status = aktivt" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="facultyAarsenhetProgramListing.searchComponent" parent="programListing.searchComponent">
    <property name="name" value="aarsenhet" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:program-type = aarsenhet AND resource:faculty = {$propertyValue:program-listing:faculty} AND resource:status = aktivt" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="facultyerEaringsbasert-masterMasterProgramListing.searchComponent" parent="programListing.searchComponent">
    <property name="name" value="erfaringsbasert-master" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:program-type = erfaringsbasert-master AND resource:faculty = {$propertyValue:program-listing:faculty} AND resource:status = aktivt" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="facultyBachelorProgramListing.searchComponent" parent="programListing.searchComponent">
    <property name="name" value="bachelor" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:program-type = bachelor AND resource:faculty = {$propertyValue:program-listing:faculty} AND resource:status = aktivt" />
        </bean>
      </list>
    </property>
  </bean>

  <bean id="facultyProfessionProgramListing.searchComponent" parent="programListing.searchComponent">
    <property name="name" value="profession" />
    <property name="queryBuilders">
      <list>
        <bean parent="queryStringParser">
          <property name="queryString"
            value="type IN program-frontpage AND resource:program-type = profesjon AND resource:faculty = {$propertyValue:program-listing:faculty} AND resource:status = aktivt" />
        </bean>
      </list>
    </property>
  </bean>


  <bean id="professionProgramListing.searchSorting" parent="articleListing.searchSorting">
    <property name="sortOrderPropDefPointers">
      <list>
        <value>title</value>
      </list>
    </property>
  </bean>

  <bean id="programListing.viewResolver" parent="decoratorViewResolver">
    <property name="views">
      <map>
        <entry key="programListing.view" value-ref="programListing.view" />
      </map>
    </property>
  </bean>

  <bean id="programListing.view" parent="collectionListing.view">
    <property name="url" value="pages/studies/view-program-listing.ftl" />
  </bean>

  <bean id="programListing.feedService" parent="collectionListing.atomService">
    <property name="order" value="-2" />
    <property name="assertions">
      <list>
        <ref bean="resourceIsProgramListing" />
        <ref bean="feedParameterSetAssertion" />
      </list>
    </property>
    <property name="handler" ref="programListing.feedHandler" />
  </bean>

  <bean id="programListing.feedHandler" parent="collectionListing.atomHandler">
    <property name="searchComponent" ref="programListing.searchComponent" />
  </bean>

</beans>
