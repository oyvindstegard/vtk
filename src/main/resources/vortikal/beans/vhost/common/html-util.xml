<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" 
"http://www.springframework.org/dtd/spring-beans.dtd">
<beans>
  
  <bean id="htmlUtil" class="org.vortikal.text.html.HtmlUtil">
    <property name="htmlParser" ref="decorating.htmlParser" />
    <property name="htmlEntityMap" ref="htmlEntityMap" />
  </bean>
  
  <bean id="htmlFormatter" class="org.vortikal.repository.resourcetype.HtmlValueFormatter">
    <property name="htmlUtil" ref="htmlUtil" />
  </bean>
  
  <bean id="htmlEntityMap" class="org.springframework.beans.factory.config.MapFactoryBean">
    <property name="sourceMap">
      <map>
        <!-- TODO: complete this list -->

        <!-- ASCII entities -->
        <entry key="quot" value="&#34;" />
        <entry key="apos" value="&#39;" />
        <entry key="amp" value="&#38;" />
        <entry key="lt" value="&#60;" />
        <entry key="gt" value="&#62;" />
        
        <!-- Latin 1 entities -->
        <entry key="nbsp" value="&#160;" />
        <entry key="iexcl" value="¡" />
        <entry key="cent" value="¢" />
        <entry key="pound" value="£" />
        <entry key="curren" value="¤" />
        <entry key="yen" value="¥" />
        <entry key="brvbar" value="¦" />
        <entry key="sect" value="§" />
        <entry key="uml" value="¨" />
        <entry key="copy" value="©" />
        <entry key="ordf" value="ª" />
        <entry key="laquo" value="«" />
        <entry key="not" value="¬" />
        <entry key="shy" value="­" />
        <entry key="reg" value="®" />
        <entry key="macr" value="¯" />
        <entry key="deg" value="°" />
        <entry key="plusmn" value="±" />
        <entry key="sup2" value="²" />
        <entry key="sup3" value="³" />
        <entry key="acute" value="´" />
        <entry key="micro" value="µ" />
        <entry key="para" value="¶" />
        <entry key="middot" value="·" />
        <entry key="cedil" value="¸" />
        <entry key="sup1" value="¹" />
        <entry key="ordm" value="º" />
        <entry key="raquo" value="»" />
        <entry key="frac14" value="¼" />
        <entry key="frac12" value="½" />
        <entry key="frac34" value="¾" />
        <entry key="iquest" value="¿" />
        <entry key="Agrave" value="À" />
        <entry key="Aacute" value="Á" />
        <entry key="Acirc" value="Â" />
        <entry key="Atilde" value="Ã" />
        <entry key="Auml" value="Ä" />
        <entry key="Aring" value="Å" />
        <entry key="AElig" value="Æ" />
        <entry key="Ccedil" value="Ç" />
        <entry key="Egrave" value="È" />
        <entry key="Eacute" value="É" />
        <entry key="Ecirc" value="Ê" />
        <entry key="Euml" value="Ë" />
        <entry key="Igrave" value="Ì" />
        <entry key="Iacute" value="Í" />
        <entry key="Icirc" value="Î" />
        <entry key="Iuml" value="Ï" />
        <entry key="ETH" value="Ð" />
        <entry key="Ntilde" value="Ñ" />
        <entry key="Ograve" value="Ò" />
        <entry key="Oacute" value="Ó" />
        <entry key="Ocirc" value="Ô" />
        <entry key="Otilde" value="Õ" />
        <entry key="Ouml" value="Ö" />
        <entry key="times" value="×" />
        <entry key="Oslash" value="Ø" />
        <entry key="Ugrave" value="Ù" />
        <entry key="Uacute" value="Ú" />
        <entry key="Ucirc" value="Û" />
        <entry key="Uuml" value="Ü" />
        <entry key="Yacute" value="Ý" />
        <entry key="THORN" value="Þ" />
        <entry key="szlig" value="ß" />
        <entry key="agrave" value="à" />
        <entry key="aacute" value="á" />
        <entry key="acirc" value="â" />
        <entry key="atilde" value="ã" />
        <entry key="auml" value="ä" />
        <entry key="aring" value="å" />
        <entry key="aelig" value="æ" />
        <entry key="ccedil" value="ç" />
        <entry key="egrave" value="è" />
        <entry key="eacute" value="é" />
        <entry key="ecirc" value="ê" />
        <entry key="euml" value="ë" />
        <entry key="igrave" value="ì" />
        <entry key="iacute" value="í" />
        <entry key="icirc" value="î" />
        <entry key="iuml" value="ï" />
        <entry key="eth" value="ð" />
        <entry key="ntilde" value="ñ" />
        <entry key="ograve" value="ò" />
        <entry key="oacute" value="ó" />
        <entry key="ocirc" value="ô" />
        <entry key="otilde" value="õ" />
        <entry key="ouml" value="ö" />
        <entry key="divide" value="÷" />
        <entry key="oslash" value="ø" />
        <entry key="ugrave" value="ù" />
        <entry key="uacute" value="ú" />
        <entry key="ucirc" value="û" />
        <entry key="uuml" value="ü" />
        <entry key="yacute" value="ý" />
        <entry key="thorn" value="þ" />
        <entry key="yuml" value="ÿ" />
      </map>
    </property>
  </bean>
  
  <bean id="safeHtml.filter" class="org.vortikal.text.html.SimpleHtmlPageFilter">
    <property name="illegalElements" ref="safeHtml.illegalElementSet" />
    <property name="validElements" ref="safeHtml.validElementSet" />
  </bean>
  
  <bean id="safeHtml.illegalElementSet" class="org.springframework.beans.factory.config.SetFactoryBean">
    <property name="sourceSet">
      <set>
        <value>script</value>
        <value>style</value>
        <value>form</value>
        <value>input</value>
        <value>frameset</value>
        <value>frame</value>
        <value>iframe</value>
        <value>object</value>
        <value>embed</value>
        <value>meta</value>
        <value>link</value>
      </set>
    </property>
  </bean>
  
  <bean id="safeHtml.validElementSet" class="org.springframework.beans.factory.config.SetFactoryBean">
    <property name="sourceSet">
      <set>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="a" />
          <property name="attributes">
            <set>
              <value>href</value>
            </set>
          </property>
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="div" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="p" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="ul" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="li" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="ol" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="em" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="strong" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="cite" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="code" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="strike" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="u" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="img" />
          <property name="validAsEmpty" value="true" />
          <property name="attributes">
            <set>
              <value>src</value>
              <value>alt</value>
            </set>
          </property>
        </bean>
      </set>
    </property>
  </bean>
  
  <bean id="decorating.htmlParser" class="org.vortikal.text.html.HtmlPageParserImpl">
    <property name="compositeTags" ref="decorating.htmlParser.compositeTags" />
    <property name="emptyTags" ref="decorating.htmlParser.emptyTags" />
  </bean>
  
  <bean id="decorating.htmlParser.compositeTags" class="org.springframework.beans.factory.config.SetFactoryBean">
    <property name="sourceSet">
      <set>
        <value>button</value>
        <value>pre</value>
        <value>b</value>
        <value>address</value>
        <value>map</value>
        <value>thead</value>
        <value>tfoot</value>
        <value>tbody</value>
        <value>fieldset</value>
        <value>colgroup</value>
        <value>optgroup</value>
        <value>small</value>
        <value>big</value>
        <value>i</value>
        <value>tt</value>
        <value>em</value>
        <value>acronym</value>
        <value>strong</value>
        <value>code</value>
        <value>samp</value>
        <value>kbd</value>
        <value>var</value>
        <value>iframe</value>
        <value>v:component</value>
      </set>
    </property>
  </bean>
  
  <bean id="decorating.htmlParser.emptyTags" class="org.springframework.beans.factory.config.SetFactoryBean">
    <property name="sourceSet">
      <set>
        <value>br</value>
        <value>area</value>
        <value>link</value>
        <value>img</value>
        <value>param</value>
        <value>hr</value>
        <value>input</value>
        <value>col</value>
        <value>base</value>
        <value>meta</value>
        <value>v:parameter</value>
      </set>
    </property>
  </bean>
  
</beans>
