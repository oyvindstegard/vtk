<?xml version="1.0" encoding="utf-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">

  <bean id="structuredResources.resourceManager" class="org.vortikal.resourcemanagement.StructuredResourceManager">
    <property name="resourceTypeTree" ref="resourceTypeTree" />
    <property name="baseType" ref="json.managedObjectResourceType" />
    <property name="valueFactory" ref="valueFactory" />
    <property name="valueFormatterRegistry" ref="valueFormatterRegistry" />
    <property name="assertion" ref="json.objectHasResourceTypeAssertion" />
    <property name="serviceInvoker" ref="externalServiceInvoker" />

    <property name="linksDef" ref="structuredResources.linksPropDef" />

  </bean>

  <bean id="structuredResource.parser" class="org.vortikal.resourcemanagement.parser.StructuredResourceParser">
    <property name="defaultResourceTypeDefinitions" value="${structuredResources.definitionsLocation}" />
    <property name="structuredResourceManager" ref="structuredResources.resourceManager" />
  </bean>

  <bean id="externalServiceInvoker" class="org.vortikal.resourcemanagement.service.ExternalServiceInvoker" />
  

  <bean id="structuredResources.linksPropDef"
        class="org.vortikal.repository.resourcetype.OverridingPropertyTypeDefinitionImpl">
    <property name="overriddenPropDef" ref="linksPropDef" />
    <property name="propertyEvaluator" ref="resourceLinksEvaluator" />
  </bean>

</beans>
