<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" 
  "http://www.springframework.org/dtd/spring-beans.dtd">

<beans>


  <!-- WEB controllers -->

  <bean id="logoutHandler" 
    class="org.vortikal.web.controller.LogoutController" parent="requestLocalRepositoryAware">
    <property name="service" ref="viewService" />
    <property name="securityInitializer" ref="securityInitializer" />
  </bean>

  <bean id="redirectHandler" 
    class="org.vortikal.web.controller.RedirectController">
    <property name="viewName" value="collectionRedirect" />
  </bean>

  <bean id="httpOptionsHandler"
        class="org.vortikal.web.controller.ResourceAwareParameterizableViewController"
        parent="requestLocalRepositoryAware">
    <property name="supportedMethods" value="OPTIONS" />
    <property name="viewName" value="httpOptions" />
  </bean>

  <!--
  <bean id="collectionListingHandler" 
    class="org.vortikal.web.controller.DisplayResourceController"
    parent="requestLocalRepositoryAware">
    <property name="viewName" value="collectionListing" />
    <property name="displayProcessed" value="true" />
  </bean>
  -->
  
  <bean id="displayIndexFileHandler" class="org.vortikal.web.controller.IndexFileController"
        parent="requestLocalRepositoryAware">
    <property name="uriCharacterEncoding" value="${indexFileHandlerURIEncoding}" />
  </bean>

  <bean id="collectionListingAsFeedHandler" 
    class="org.vortikal.web.controller.ResourceAwareParameterizableViewController"
    parent="requestLocalRepositoryAware">
    <property name="viewName" value="collectionListingAsFeed" />
  </bean>
  
  <bean id="displayResourceHandler" 
    class="org.vortikal.web.controller.DisplayResourceController"
    parent="requestLocalRepositoryAware">
    <property name="displayProcessed" value="true" />
  </bean>

  <bean id="displayHTMLResourceHandler" 
    class="org.vortikal.web.controller.DisplayResourceController"
    parent="requestLocalRepositoryAware">
    <property name="displayProcessed" value="true" />
    <property name="viewName" value="displayHTMLResource" />
  </bean>

  <bean id="displayArticleHandler" 
    class="org.vortikal.edit.editor.ResourceViewController">
    <property name="viewName" value="displayArticle" />
    <property name="resourceManager" ref="resourceManager"/>
  </bean>


  <bean id="resourceManager"
        class="org.vortikal.edit.editor.ResourceWrapperManager"
        parent="requestLocalRepositoryAware">
    <property name="htmlParser" ref="decorating.htmlParser" />
    <property name="htmlPropsFilter" ref="resourceManager.htmlPropsFilter" />
    <property name="contentResourceType" ref="xhtml10TransResourceTypeDefinition" />
  </bean>


  <bean id="resourceManager.htmlPropsFilter" class="org.vortikal.text.html.SimpleHtmlPageFilter">
    <property name="keepComments" value="false" />
    <property name="illegalElements" ref="resourceManager.htmlPropsFilter.illegalHtmlElementSet" />
    <property name="validElements" ref="resourceManager.htmlPropsFilter.validHtmlElementSet" />
  </bean>

  <bean id="resourceManager.htmlPropsFilter.illegalHtmlElementSet"
        class="org.springframework.beans.factory.config.SetFactoryBean">
    <property name="sourceSet">
      <set>
        <value>script</value>
        <value>style</value>
        <value>form</value>
        <value>input</value>
        <value>frameset</value>
        <value>frame</value>
        <value>iframe</value>
        <value>object</value>
        <value>embed</value>
      </set>
    </property>
  </bean>

  <bean id="resourceManager.htmlPropsFilter.validHtmlElementSet"
        class="org.springframework.beans.factory.config.SetFactoryBean">
    <property name="sourceSet">
      <set>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="a" />
          <property name="attributes">
            <set>
              <value>href</value>
            </set>
          </property>
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="p" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="sub" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="sup" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="em" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="strong" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="cite" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="code" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="strike" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="u" />
        </bean>
        <!--
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="ul" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="li" />
        </bean>
        <bean class="org.vortikal.text.html.HtmlElementDescriptor">
          <property name="name" value="ol" />
        </bean>
        -->
      </set>
    </property>
  </bean>

</beans>
