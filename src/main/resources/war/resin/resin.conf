<!--
   - Configuration file template for resin 3.0.
  -->
<resin xmlns="http://caucho.com/ns/resin"
       xmlns:resin="http://caucho.com/ns/resin/core">

  <system-property file.encoding="utf-8"/>
  <character-encoding>utf-8</character-encoding>

  <log name='' level='warning' path='stdout:' timestamp='[%H:%M:%S.%s] '/>
  <log name='com.caucho.java' level='warning' path='stdout:' timestamp='[%H:%M:%S.%s] '/>
  <log name='com.caucho.loader' level='warning' path='stdout:' timestamp='[%H:%M:%S.%s] '/>

  <dependency-check-interval>2s</dependency-check-interval>

  <javac compiler="internal" args=""/>

  <!--
     - Configures threads shared among all HTTP and SRUN ports.
    -->
  <thread-pool>
    <!-- Maximum number of threads. -->
    <thread-max>128</thread-max>

    <!-- Minimum number of spare connection threads. -->
    <spare-thread-min>25</spare-thread-min>
  </thread-pool>

  <!--
     - Configures the minimum free memory allowed before Resin
     - will force a restart.
    -->
  <min-free-memory>1M</min-free-memory>

  <server>
    <class-loader>

      <!-- adds all .jar files under the resin/lib directory -->
      <tree-loader path="$resin-home/lib"/>
    </class-loader>


    <!-- Configures the keepalive -->
    <keepalive-max>500</keepalive-max>
    <keepalive-timeout>120s</keepalive-timeout>

    <http port="${webPort}"/>
    <http port="${webdavPort}"/>

    <!-- Import custom configuration from user's home directory if it exists -->
    <resin:import path="${Var['user.home']}/resin-custom.conf" optional="true"/>

    <!--
       - Enables/disables exceptions when the browser closes a connection.
      -->
    <ignore-client-disconnect>true</ignore-client-disconnect>

    <!--
       - Defaults applied to each web-app.
      -->
    <web-app-default>

      <class-loader>
        <tree-loader path="${server.rootDirectory}/ext-webapp"/>
        <compiling-loader path='WEB-INF/classes'/>
        <library-loader path='WEB-INF/lib'/>
      </class-loader>

      <resin:import path="WEB-INF/web.xml" optional="true"/>

    </web-app-default>

    <resin:import path="${resinHome}/conf/app-default.xml"/>

    <host id="">

      <root-directory>${targetPath}</root-directory>

      <class-loader><servlet-hack/></class-loader>

      <system-property org.apache.commons.logging.Log =
                       "org.apache.commons.logging.impl.Log4JLogger"/>
      <system-property log4j.configuration="log4j.vortex.xml"/>
      <system-property no.uio.webapps.log.path="${logPath}" />

      <!--
      <system-property org.xml.sax.driver = "org.apache.xerces.parsers.SAXParser" />
      <system-property org.xml.sax.parser = "org.apache.xerces.parsers.SAXParser" />
      -->
      <system-property javax.xml.parsers.SAXParserFactory = 
                       "org.apache.xerces.jaxp.SAXParserFactoryImpl"/>
      <system-property javax.xml.transform.TransformerFactory =
                       "org.apache.xalan.processor.TransformerFactoryImpl"/>

      <system-property javax.xml.parsers.DocumentBuilderFactory =
                       "org.apache.xerces.jaxp.DocumentBuilderFactoryImpl" />

      <web-app id='/' document-directory="${webappDir}" />

    </host>
  </server>
</resin>
