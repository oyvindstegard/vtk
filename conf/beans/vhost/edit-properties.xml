<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" 
"http://www.springframework.org/dtd/spring-beans.dtd">

<beans>


  <bean id="editPropertiesService" class="org.vortikal.web.service.ServiceImpl">
    <property name="parent" ref="manageService" />
    <!--property name="order"><value>9600</value></property-->
    <property name="categories">
      <set>
        <value>tabMenu</value>
      </set>
    </property>
    <property name="attributes">
      <map>
        <entry key="tabOrder"><value type="java.lang.Integer">400</value></entry>
      </map>
    </property>
    <property name="assertions">
      <list>
        <bean class="org.vortikal.web.service.RequestParameterAssertion">
          <property name="parameterName">
            <value>mode</value>
          </property>
          <property name="parameterValue">
            <value>edit-properties</value>
          </property>
        </bean>      
      </list>
    </property>
    <property name="services">
      <list>
        <ref bean="editBasicPropertiesService" />
        <ref bean="editUhtmlPropertiesService" />
        <ref bean="editTechnicalDetailsPropertiesService" />
        <ref bean="editInformationDescribingContentPropertiesService" />
      </list>
    </property>
    <property name="handler" ref="editBasicPropertiesHandler" />
  </bean>        

  <bean id="editBasicPropertiesService" class="org.vortikal.web.service.ServiceImpl">
    <property name="parent" ref="editPropertiesService" />
    <property name="assertions">
      <list>
        <bean class="org.vortikal.web.service.RequestParameterAssertion">
          <property name="parameterName" value="group" />
          <property name="parameterValue" value="basic" />
        </bean>      
      </list>
    </property>
    <property name="handler" ref="editBasicPropertiesHandler" />
  </bean>        

  <bean id="editUhtmlPropertiesService" class="org.vortikal.web.service.ServiceImpl">
    <property name="parent" ref="editPropertiesService" />
    <property name="assertions">
      <list>
        <bean class="org.vortikal.web.service.RequestParameterAssertion">
          <property name="parameterName" value="group" />
          <property name="parameterValue" value="uhtml" />
        </bean>      
      </list>
    </property>
    <property name="handler" ref="editUhtmlPropertiesHandler" />
  </bean>        


  <bean id="editInformationDescribingContentPropertiesService" class="org.vortikal.web.service.ServiceImpl">
    <property name="parent" ref="editPropertiesService" />
    <property name="assertions">
      <list>
        <bean class="org.vortikal.web.service.RequestParameterAssertion">
          <property name="parameterName" value="group" />
          <property name="parameterValue" value="info-content" />
        </bean>      
      </list>
    </property>
    <property name="handler" ref="editInformationDescribingContentPropertiesHandler" />
  </bean>        
  
  <bean id="editTechnicalDetailsPropertiesService" class="org.vortikal.web.service.ServiceImpl">
    <property name="parent" ref="editPropertiesService" />
    <property name="assertions">
      <list>
        <bean class="org.vortikal.web.service.RequestParameterAssertion">
          <property name="parameterName" value="group" />
          <property name="parameterValue" value="tecnical-details" />
        </bean>      
      </list>
    </property>
    <property name="handler" ref="editTechnicalDetailsPropertiesHandler" />
  </bean>        
  
  
  <bean id="editBasicPropertiesHandler" 
    class="org.vortikal.web.controller.properties.PropertyEditController"
    parent="requestLocalRepositoryAware">
    <property name="principalManager" ref="principalManager" />
    <property name="propertyTypeDefinitions">
      <list>
        <ref bean="lastModifiedPropDef" />
        <ref bean="modifiedByPropDef" />
        <ref bean="creationTimePropDef" />
        <ref bean="createdByPropDef" />
        <ref bean="ownerPropDef" />
        <!-- resourceType -->
        <!-- webadress -->
        <!-- webDAVadress -->
        <ref bean="contentLocalePropDef" />
        <ref bean="contentLengthPropDef" />
      </list>
    </property>
    <property name="modelKey" value="basicPropList" />
    <property name="service" ref="editBasicPropertiesService" />

    <property name="valueFactory" ref="valueFactory" />
    <property name="formView" value="editProperties" />
    <property name="successView" value="editProperties" />

    <property name="commandName" value="form" />
    <property name="dateFormat" value="dd.MM.yyyy HH:mm:ss" />
    <!--
    <property name="commandClass">
      <value>org.vortikal.web.controller.properties.ResourceEnumerationPropertyCommand</value>
    </property>
    -->
  </bean>

  <bean id="editUhtmlPropertiesHandler" 
    class="org.vortikal.web.controller.properties.PropertyEditController"
    parent="requestLocalRepositoryAware">
    <property name="principalManager" ref="principalManager" />
    <property name="propertyTypeDefinitions">
      <list>
        <ref bean="unitPropDef" />
        <ref bean="topicPropDef" />
      </list>
    </property>
    <property name="modelKey" value="uhtmlPropList" />
    <property name="service" ref="editUhtmlPropertiesService" />
    <property name="valueFactory" ref="valueFactory" />
    <property name="formView" value="editProperties" />
    <property name="successView" value="editProperties" />

    <property name="commandName" value="form" />
    <property name="dateFormat" value="dd.MM.yyyy HH:mm:ss" />
    <!--
    <property name="commandClass">
      <value>org.vortikal.web.controller.properties.ResourceEnumerationPropertyCommand</value>
    </property>
    -->
  </bean>

  <bean id="editInformationDescribingContentPropertiesHandler" 
    class="org.vortikal.web.controller.properties.PropertyEditController"
    parent="requestLocalRepositoryAware">
    <property name="principalManager" ref="principalManager" />
    <property name="propertyTypeDefinitions">
      <list>
        <!-- ref bean="titlePropDef" / -->
        <ref bean="shortTitlePropDef" />
        <ref bean="keywordsPropDef" />
        <ref bean="descriptionPropDef" />
      </list>
    </property>
    <property name="modelKey" value="informationDescribingContentPropList" />
    <property name="service" ref="editInformationDescribingContentPropertiesService" />

    <property name="valueFactory" ref="valueFactory" />
    <property name="formView" value="editProperties" />
    <property name="successView" value="editProperties" />

    <property name="commandName" value="form" />
    <property name="dateFormat" value="dd.MM.yyyy HH:mm:ss" />
    <!--
    <property name="commandClass">
      <value>org.vortikal.web.controller.properties.ResourceEnumerationPropertyCommand</value>
    </property>
    -->
  </bean>

  <bean id="editTechnicalDetailsPropertiesHandler" 
    class="org.vortikal.web.controller.properties.PropertyEditController"
    parent="requestLocalRepositoryAware">
    <property name="principalManager" ref="principalManager" />
    <property name="propertyTypeDefinitions">
      <list>
        <ref bean="contentTypePropDef" />
        <ref bean="userSetCharacterEncodingPropDef" />
        <ref bean="guessedCharacterEncodingPropDef" />
        <ref bean="characterEncodingPropDef" />
      </list>
    </property>
    <property name="modelKey" value="technicalDetailsPropList" />
    <property name="service" ref="editTechnicalDetailsPropertiesService" />

    <property name="valueFactory" ref="valueFactory" />
    <property name="formView" value="editProperties" />
    <property name="successView" value="editProperties" />

    <property name="commandName" value="form" />
    <property name="dateFormat" value="dd.MM.yyyy HH:mm:ss" />
    <!--
    <property name="commandClass">
      <value>org.vortikal.web.controller.properties.ResourceEnumerationPropertyCommand</value>
    </property>
    -->
  </bean>


  <bean id="editPropertiesView" parent="freemarkerView">
    <property name="url" value="pages/properties-listing.ftl" />
    <property name="referenceDataProviders">
      <list>
         <ref bean="editBasicPropertiesHandler" /> 
        <ref bean="editUhtmlPropertiesHandler" />
        <ref bean="editInformationDescribingContentPropertiesHandler"/>
        <ref bean="editTechnicalDetailsPropertiesHandler"/>
        <ref bean="adminCSSProvider" />
      </list>
    </property>
  </bean>


  <bean id="adminViewResolver2" 
        parent="adminViewResolver">
    <property name="views">
      <map>
        <entry key="editProperties" value-ref="editPropertiesView" />
      </map>
    </property>
  </bean>


</beans>
